{% extends 'base.html.twig' %}

{% block title %}Réservation au guichet{% endblock %}

{% block body %}
    <h1 class="text-center text-warning mb-4">Réservation pour {{ seance.film.title }}</h1>

    <div class="d-flex flex-column align-items-center gap-2">
        {% for row in seats|batch(16, '') %}
            <div class="d-flex gap-1 justify-content-center">
                {% for seat in row %}
                    {% if seat %}
                        {% set isReserved = seat.id in reservedSeatIds %}
                        <div
                            class="seat text-white fw-bold d-flex justify-content-center align-items-center"
                            data-seat-id="{{ seat.id }}"
                            data-disabled="{{ isReserved ? 'true' : 'false' }}"
                            style="
                                width:40px; height:40px; border-radius:5px;
                                background-color: {{ isReserved ? '#dc3545' : '#6c757d' }};
                                cursor: {{ isReserved ? 'not-allowed' : 'pointer' }};
                                "
                        >
                            {{ seat.number }}
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        {% endfor %}
    </div>






    <button class="btn btn-success mt-4 d-block mx-auto" id="confirm-reservation">Confirmer la réservation</button>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.seat').forEach(seat => {
                if (seat.dataset.disabled === "true") {
                    return; // siège déjà réservé, pas cliquable
                }

                seat.addEventListener('click', () => {
                    const currentColor = seat.style.backgroundColor;

                    if (currentColor === 'blue') {
                        // Si déjà sélectionné (bleu), on désélectionne (gris)
                        seat.style.backgroundColor = '#6c757d';
                    } else {
                        // Sinon, on sélectionne en bleu
                        seat.style.backgroundColor = 'blue';
                    }
                });
            });
        });

    </script>
{% endblock %}
